# Code example

```swift
do {
    switch (task?.body, try task?.body.getBodyLength()) {
    case (.none, _):
        set(requestBodyLength: .noBody)
    case (_, .some(let length)):
        set(requestBodyLength: .length(length))
        task!.countOfBytesExpectedToSend = Int64(length)
    case (_, .none):
        set(requestBodyLength: .unknown)
    }
} catch let e {
    self.internalState = .transferFailed
    failWith(errorCode: errorCode(fileSystemError: e), request: request)
    return
}
```
